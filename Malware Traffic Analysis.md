# <p align="center"> Malware Traffic Analysis

As technology progresses, traditional malware variants like trojans, virus and worms tend to evolve and launch attacks on non traditional ways, damaging the system without being detected. 
* The ransomware activity has been escalating lately, damaging businesses greatly. That’s why malware analysis is an important process for dissecting malware and understanding its main components, source code, functionality, characteristics, origin and impact to prevent it or at least mitigate it.
* The main objectives of malware analysis are:
	* It breaks down the malware: Malware is just another software program but with the sole purpose of causing harm. Therefore, understanding its code and functionality is vital.
	* It investigates its characteristics: Knowing the exact characteristics and the unique digital footprint that the software leaves is key. Data approach, replication pace, camouflage tactic, spread method.
	* It unravels its functionality: Reviewing the malware code is probably the most important aspect, since malware typically waits hidden for the right moment to strike. Analyzing the code allows us to understand its functionality and intent.
	* It traces the malware origin: Even though it is hard to trace the origin of the malware, traffic analysis tries lo look for an IP, geographic location, organization, name or anything that could lead to the responsible party. 
	* It tries to predict the impact: By putting these pieces together once can arrive to a probable impact profile, that can indicate the worst case scenario. Based on these results companies can plan ahead and deploy mitigation procedures.

* However, malware analysis requires years of practice, highly technical skills and patience since it is an arduous process. The process for malware analysis is:
* Capture the Malware: In order to analyze the malware, an uncompressed malicious piece of the code needs to be captured. HoneyDB is one of the tools that attract and capture malware.
* Build a Malware Lab: It is important to have a safe environment to test different malware functionalities, like VMs, to sandbox test and don’t risk nearby files.
* Install your Tools: There are plenty of paid and open-source tools that can be utilized, Github and cuckoo Sandbox are good examples.
* Record the Baseline: It is important to document the baseline environment before running the malware.
* Commence your Investigation: Dissect the malware to reveal its properties at every layer, automating tools can perform some analysis, while others will require intense manual labor.
* Document the results: Tools installed wil help at this step, providing detailed information on behavior,interaction patterns and tendencies. All this should be documented to be shared with different entities and increase a database for detection.

* On the other hand, there are typically 2 types of analysis, static and dynamic but adding if it needed a manual or automated analysis will make it more complete.
	* Static: The examination of headers, embedded assets, metadata, etc. This information will help create an Indicator of Compromise (IOC), which documents the nature of the software.
	* Dynamic: The malware is left to act freely in a control environment to analyze its behavior. It is important to analyze its interactions with network traffic like targeting patterns, changes to the registry, and compare the baseline environment before and after the test. 
	* Manual: Uses tools like debuggers, decompilers and decrypters to break down the code, analyzing the code helps understand the logic behind elements that might seem unnecessary at first. This is also known as code reversing.
	* Automated: This method might not provide insights into the software’s logic but the automated workflow analyzes different behaviors and static properties quickly  making it easy to classify the malware. Falcon SandBox and AI-powered SNDBOX are some clear example tools.

* Each type of analysis has their pros and cons, but utilizing all of them in conjunction will provide a holistic picture of the malware capabilities. Additionally, using the manual code reversal approach helps to find the reason for the malware creation.
* Similar to the process, there are 3 stages for Malware Analysis that provide traits and identity of the malware.
	* Observing Malware Behavior: At first, analysts perform actions to trigger the malware to execute, in order to determine if the malware is a potential threat or harmless. Wireshark is a pretty useful tool that simulates multiple network conditions and inspect malware behavior in the face of different protocols. Also, one can use the behavioral analysis framework to create a reusable analysis script when combining the manual and automation strategy. This will put the malware through paces in a live virtual environment. 
	* Disassembling the Code: The core and inner logic are analyzed in this stage, a ready to use disassembler can also be used for this since it relies heavily on manual efforts, and knowledge in binary/assembly language. A disassembler deconstructs the malware into binary to then reconstructed to assembly language that can be understood. Then, a debugger conducts a code walkthrough to record suspicious code for analysis. Lastly, a decompiler recreates the original source code of a program and can help identify a coder’s digital fingerprint to trace its origin.
* Examining the Memory: This stage focuses on the potential impact by analyzing the forensic artifacts left behind in the memory of the system. The average malware is often 1 MB or less, so this is when the environment with special conditions plays a role since an everyday computer/environment would make it really hard. Once the malware is run, one looks to extract artifacts/digital imprints left behind by its functionality. Memoryze is a tool that helps with this identifying loaded drivers, verifying dru=iver signatures, displaying any open network sockets and listing all running processes (even hidden ones).

* These stages focus on learning about the malware identity, how it works and behavior in different scenarios. However, there are also some key practices to follow for this process, since he procedure can be complex:
	* Expand your malware sample size continuously: The bigger your data sample base the higher chances to catch the malware before it can do any damage, that is why it is important to work with ethical hackers, corporates and cybersecurity companies, to increase the sample base and have the latest. Have in mind that an unfamiliar or new malware may not be recognized by your database.
	* Use automation to optimize your efforts: This will drastically reduce analysis time and guide you in the right direction for when manual analysis is needed. Automation will provide an accurate profile of malware behavior in typical conditions and help you identify the malware family, so one can focus on code reversal and the application’s logic to implement prevention measures.
	* Always use a secure environment to run malware: Sandboxes created by VMs are highly recommended because the malware can spread to any portable file and escape the controlled environment. They are also helpful to run memory forensics because of the clear boundaries.
	* Only analyze malware whose remote infrastructure is running: Since most malware report back to the actor, one needs to use slightly aging malware samples. A malware that have been set aside for some time is likely to have an inactive remote infrastructure.
	* Capture and Store VM image snapshots: Taking snapshots at regular intervals will help us capture the malware functionality and observe its behavior over time. This is a good practice to perfect malware analysis, redo any errors and come back at any point if necessary. 
* Do your research and select the best fit malware analysis tools: The malware analysis market keeps evolving so look for the best tools that fit your specific needs. Some useful ones ares CIRCL Dynamic Malware Analysis Platform, Dinoflux and Sndbox. However, always check for new ones since the malware variants keep evolving and the tools need to evolve as well.
